From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 10:50:06 +0100
Subject: CVE-2022-0714

Origin: https://github.com/vim/vim/commit/4e889f98e95ac05d7c8bd3ee933ab4d47820fdfa
---
 src/edit.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/edit.c b/src/edit.c
index 8243890..a675c71 100644
--- a/src/edit.c
+++ b/src/edit.c
@@ -1956,6 +1956,8 @@ change_indent(type, amount, round, replaced, call_changed_bytes)
 	    else
 #endif
 		++new_cursor_col;
+	    if (ptr[new_cursor_col] == NUL)
+		break;
 	    vcol += lbr_chartabsize(ptr, ptr + new_cursor_col, (colnr_T)vcol);
 	}
 	vcol = last_vcol;
