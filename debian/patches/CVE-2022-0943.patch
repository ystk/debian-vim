From: Markus Koschany <apo@debian.org>
Date: Wed, 21 Jun 2022 11:18:41 +0200
Subject: CVE-2022-0943

Origin: https://github.com/vim/vim/commit/5c68617d395f9d7b824f68475b24ce3e38d653a3
---
 src/spell.c | 4 ++++
 1 file changed, 4 insertions(+)

--- a/src/spell.c
+++ b/src/spell.c
@@ -10227,6 +10227,10 @@ spell_suggest(count)
 	    curwin->w_cursor.col = VIsual.col;
 	++badlen;
 	end_visual_mode();
+	// make sure we don't include the NUL at the end of the line
+	line = ml_get_curline();
+	if (badlen > STRLEN(line) - curwin->w_cursor.col)
+	    badlen = STRLEN(line) - curwin->w_cursor.col;
     }
     /* Find the start of the badly spelled word. */
     else if (spell_move_to(curwin, FORWARD, TRUE, TRUE, NULL) == 0
