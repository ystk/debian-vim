From: Markus Koschany <apo@debian.org>
Date: Thu, 10 Nov 2022 17:59:12 +0100
Subject: CVE-2022-2285

Origin: https://github.com/vim/vim/commit/27efc62f5d86afcb2ecb7565587fe8dea4b036fe
---
 src/term.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/term.c b/src/term.c
index a1ab537..cd617bb 100644
--- a/src/term.c
+++ b/src/term.c
@@ -4048,6 +4048,7 @@ check_termcode(max_offset, buf, bufsize, buflen)
 	if (*tp == ESC && !p_ek && (State & INSERT))
 	    continue;
 
+	tp[len] = NUL;
 	key_name[0] = NUL;	/* no key name found yet */
 	key_name[1] = NUL;	/* no key name found yet */
 	modifiers = 0;		/* no modifiers yet */
