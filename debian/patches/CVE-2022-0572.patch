From: Markus Koschany <apo@debian.org>
Date: Tue, 17 May 2022 15:50:50 +0200
Subject: CVE-2022-0572

Origin: https://github.com/vim/vim/commit/6e28703a8e41f775f64e442c5d11ce1ff599aa3f
---
 src/ex_cmds.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/ex_cmds.c b/src/ex_cmds.c
index fe51e7c..9b3eaa9 100644
--- a/src/ex_cmds.c
+++ b/src/ex_cmds.c
@@ -696,6 +696,10 @@ ex_retab(eap)
 	    if (ptr[col] == NUL)
 		break;
 	    vcol += chartabsize(ptr + col, (colnr_T)vcol);
+	    if (vcol >= MAXCOL)
+	    {
+		break;
+	    }
 #ifdef FEAT_MBYTE
 	    if (has_mbyte)
 		col += (*mb_ptr2len)(ptr + col);
