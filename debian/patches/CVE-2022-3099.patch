From: Markus Koschany <apo@debian.org>
Date: Thu, 10 Nov 2022 17:08:36 +0100
Subject: CVE-2022-3099

Origin: https://github.com/vim/vim/commit/35d21c6830fc2d68aca838424a0e786821c5891c
---
 src/ex_docmd.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/ex_docmd.c b/src/ex_docmd.c
index a9e969e..f5f098a 100644
--- a/src/ex_docmd.c
+++ b/src/ex_docmd.c
@@ -1208,7 +1208,7 @@ do_cmdline(cmdline, fgetline, cookie, flags)
 
 		    /* Check for the next breakpoint at or after the ":while"
 		     * or ":for". */
-		    if (breakpoint != NULL)
+		    if (breakpoint != NULL && lines_ga.ga_len > current_line)
 		    {
 			*breakpoint = dbg_find_breakpoint(
 			       getline_equal(fgetline, cookie, getsourceline),
