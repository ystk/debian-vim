From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 09:55:43 +0100
Subject: CVE-2021-3928

Origin: https://github.com/vim/vim/commit/15d9890eee53afc61eb0a03b878a19cb5672f732
---
 src/spell.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/src/spell.c
+++ b/src/spell.c
@@ -11751,7 +11751,7 @@ suggest_trie_walk(su, lp, fword, soundfo
 		     * char, e.g., "thes," -> "these". */
 		    p = fword + sp->ts_fidx;
 		    mb_ptr_back(fword, p);
-		    if (!spell_iswordp(p, curwin))
+		    if (!spell_iswordp(p, curwin) && *preword != NUL)
 		    {
 			p = preword + STRLEN(preword);
 			mb_ptr_back(preword, p);
