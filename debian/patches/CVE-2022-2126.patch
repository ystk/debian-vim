From: Markus Koschany <apo@debian.org>
Date: Wed, 21 Jun 2022 11:21:36 +0200
Subject: CVE-2022-2126

Origin: https://github.com/vim/vim/commit/156d3911952d73b03d7420dc3540215247db0fe8
---
 src/spell.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/spell.c b/src/spell.c
index 7f05539..c227b52 100644
--- a/src/spell.c
+++ b/src/spell.c
@@ -12115,7 +12115,8 @@ suggest_trie_walk(su, lp, fword, soundfold)
 			    sp->ts_isdiff = (newscore != 0)
 						       ? DIFF_YES : DIFF_NONE;
 			}
-			else if (sp->ts_isdiff == DIFF_INSERT)
+			else if (sp->ts_isdiff == DIFF_INSERT
+				    && sp->ts_fidx > 0)
 			    /* When inserting trail bytes don't advance in the
 			     * bad word. */
 			    --sp->ts_fidx;
