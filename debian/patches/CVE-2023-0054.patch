From: Markus Koschany <apo@debian.org>
Date: Fri, 9 Jun 2023 17:55:18 +0200
Subject: CVE-2023-0054

Origin: https://github.com/vim/vim/commit/3ac1d97a1d9353490493d30088256360435f7731
---
 src/eval.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/eval.c b/src/eval.c
index 76c5fcc..631f525 100644
--- a/src/eval.c
+++ b/src/eval.c
@@ -25142,6 +25142,11 @@ do_string_sub(str, pat, sub, flags)
 	     * - The text after the match.
 	     */
 	    sublen = vim_regsub(&regmatch, sub, tail, FALSE, TRUE, FALSE);
+	    if (sublen <= 0)
+	    {
+		ga_clear(&ga);
+		break;
+	    }
 	    if (ga_grow(&ga, (int)(STRLEN(tail) + sublen -
 			    (regmatch.endp[0] - regmatch.startp[0]))) == FAIL)
 	    {
