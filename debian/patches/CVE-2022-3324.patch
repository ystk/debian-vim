From: Markus Koschany <apo@debian.org>
Date: Thu, 10 Nov 2022 17:10:12 +0100
Subject: CVE-2022-3324

Origin: https://github.com/vim/vim/commit/8279af514ca7e5fd3c31cf13b0864163d1a0bfeb
---
 src/window.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/window.c b/src/window.c
index 904f752..5f75688 100644
--- a/src/window.c
+++ b/src/window.c
@@ -1894,6 +1894,8 @@ win_equal_rec(next_curwin, current, topfr, dir, col, row, width, height)
 		if (hnc)	    /* add next_curwin size */
 		{
 		    next_curwin_size -= p_wiw - (m - n);
+		    if (next_curwin_size < 0)
+			next_curwin_size = 0;
 		    new_size += next_curwin_size;
 		    room -= new_size - next_curwin_size;
 		}
@@ -5872,7 +5874,8 @@ win_new_width(wp, width)
     win_T	*wp;
     int		width;
 {
-    wp->w_width = width;
+    // Should we give an error if width < 0?
+    wp->w_width = width < 0 ? 0 : width;
     wp->w_lines_valid = 0;
     changed_line_abv_curs_win(wp);
     invalidate_botline_win(wp);
