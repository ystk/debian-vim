From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 10:50:32 +0100
Subject: CVE-2022-0729

Origin: https://github.com/vim/vim/commit/6456fae9ba8e72c74b2c0c499eaf09974604ff30
---
 src/regexp.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/regexp.c b/src/regexp.c
index 6d4d3e8..ab4ac86 100644
--- a/src/regexp.c
+++ b/src/regexp.c
@@ -5680,6 +5680,11 @@ regmatch(scan)
 			    if (reginput == regline)
 			    {
 				/* backup to last char of previous line */
+				if (reglnum == 0)
+				{
+				    status = RA_NOMATCH;
+				    break;
+				}
 				--reglnum;
 				regline = reg_getline(reglnum);
 				/* Just in case regrepeat() didn't count
