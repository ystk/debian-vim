From: Markus Koschany <apo@debian.org>
Date: Tue, 17 May 2022 16:03:46 +0200
Subject: CVE-2022-1619

Origin: https://github.com/vim/vim/commit/ef02f16609ff0a26ffc6e20263523424980898fe
---
 src/ex_getln.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/src/ex_getln.c
+++ b/src/ex_getln.c
@@ -986,10 +986,14 @@ getcmdline(firstc, count, indent)
 		    {
 			while (p > ccline.cmdbuff && vim_isspace(p[-1]))
 			    --p;
+		    if (p > ccline.cmdbuff)
+	        {
 			i = vim_iswordc(p[-1]);
-			while (p > ccline.cmdbuff && !vim_isspace(p[-1])
+		    while (p > ccline.cmdbuff && !vim_isspace(p[-1])
 				&& vim_iswordc(p[-1]) == i)
 			    --p;
+		}
+
 		    }
 		    else
 			--p;
