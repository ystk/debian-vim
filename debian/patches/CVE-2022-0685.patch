From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 10:48:08 +0100
Subject: CVE-2022-0685

Origin: https://github.com/vim/vim/commit/5921aeb5741fc6e84c870d68c7c35b93ad0c9f87
---
 src/charset.c         | 6 ++++++
 src/misc1.c           | 2 +-
 src/proto/charset.pro | 3 +--
 3 files changed, 8 insertions(+), 3 deletions(-)

--- a/src/charset.c
+++ b/src/charset.c
@@ -1691,6 +1691,12 @@ vim_isupper(c)
     return isupper(c);
 }
 
+     int
+vim_isalpha(int c)
+{
+    return vim_islower(c) || vim_isupper(c);
+}
+
     int
 vim_toupper(c)
     int	    c;
--- a/src/misc1.c
+++ b/src/misc1.c
@@ -10052,7 +10052,7 @@ unix_expandpath(gap, path, wildoff, flag
 	else if (path_end >= path + wildoff
 			 && (vim_strchr((char_u *)"*?[{~$", *path_end) != NULL
 			     || (!p_fic && (flags & EW_ICASE)
-					     && isalpha(PTR2CHAR(path_end)))))
+					     && vim_isalpha(PTR2CHAR(path_end)))))
 	    e = p;
 #ifdef FEAT_MBYTE
 	if (has_mbyte)
--- a/src/proto/charset.pro
+++ b/src/proto/charset.pro
@@ -43,6 +43,7 @@ int vim_isdigit __ARGS((int c));
 int vim_isxdigit __ARGS((int c));
 int vim_islower __ARGS((int c));
 int vim_isupper __ARGS((int c));
+int vim_isalpha(int c);
 int vim_toupper __ARGS((int c));
 int vim_tolower __ARGS((int c));
 char_u *skiptowhite __ARGS((char_u *p));
@@ -55,5 +56,3 @@ int hexhex2nr __ARGS((char_u *p));
 int rem_backslash __ARGS((char_u *str));
 void backslash_halve __ARGS((char_u *p));
 char_u *backslash_halve_save __ARGS((char_u *p));
-void ebcdic2ascii __ARGS((char_u *buffer, int len));
-/* vim: set ft=c : */
