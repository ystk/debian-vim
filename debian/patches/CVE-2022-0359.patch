From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 10:17:10 +0100
Subject: CVE-2022-0359

Origin: https://github.com/vim/vim/commit/85b6747abc15a7a81086db31289cf1b8b17e6cb1
---
 src/ex_getln.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/src/ex_getln.c
+++ b/src/ex_getln.c
@@ -241,7 +241,7 @@ getcmdline(firstc, count, indent)
     ccline.cmdindent = (firstc > 0 ? indent : 0);
 
     /* alloc initial ccline.cmdbuff */
-    alloc_cmdbuff(exmode_active ? 250 : indent + 1);
+    alloc_cmdbuff(indent + 50);
     if (ccline.cmdbuff == NULL)
 	return NULL;			    /* out of memory */
     ccline.cmdlen = ccline.cmdpos = 0;
