From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 10:01:42 +0100
Subject: CVE-2021-3984

Origin: https://github.com/vim/vim/commit/2de9b7c7c8791da8853a9a7ca9c467867465b655
---
 src/misc1.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/src/misc1.c b/src/misc1.c
index e3e7da8..5c6b192 100644
--- a/src/misc1.c
+++ b/src/misc1.c
@@ -6624,10 +6624,10 @@ cin_skip2pos(trypos)
     static pos_T *
 find_start_brace()	    /* XXX */
 {
-    pos_T	cursor_save;
-    pos_T	*trypos;
-    pos_T	*pos;
-    static pos_T	pos_copy;
+    pos_T	    cursor_save;
+    pos_T	    *trypos;
+    pos_T	    *pos;
+    static pos_T    pos_copy;
 
     cursor_save = curwin->w_cursor;
     while ((trypos = findmatchlimit(NULL, '{', FM_BLOCKSTOP, 0)) != NULL)
@@ -6641,7 +6641,7 @@ find_start_brace()	    /* XXX */
 		       && (pos = ind_find_start_comment()) == NULL) /* XXX */
 	    break;
 	if (pos != NULL)
-	    curwin->w_cursor.lnum = pos->lnum;
+	    curwin->w_cursor = *pos;
     }
     curwin->w_cursor = cursor_save;
     return trypos;
