From: Markus Koschany <apo@debian.org>
Date: Sat, 12 Mar 2022 10:14:26 +0100
Subject: CVE-2022-0213

Origin: https://github.com/vim/vim/commit/de05bb25733c3319e18dca44e9b59c6ee389eb26
---
 src/screen.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/src/screen.c
+++ b/src/screen.c
@@ -6541,12 +6541,13 @@ win_redr_status(wp)
 	p = NameBuff;
 	len = (int)STRLEN(p);
 
-	if (wp->w_buffer->b_help
+	if ((wp->w_buffer->b_help
 #ifdef FEAT_QUICKFIX
 		|| wp->w_p_pvw
 #endif
 		|| bufIsChanged(wp->w_buffer)
 		|| wp->w_buffer->b_p_ro)
+		&& len < MAXPATHL - 1)
 	    *(p + len++) = ' ';
 	if (wp->w_buffer->b_help)
 	{
